## Описание решения
Берётся предобученная модель из семейства трансформеров и делается суммаризация комментов.
Модель обучалась на специальном датасете, созданном под этот контест с помощью популярной LLM.
За счет этого получается при небольшом размере модели создавать суммаризации близкие к LLM.
Решение отличается в зависимости от выбранного типа суммаризации, соответствующий тип можно передавать в аргументах при запуске. 
Логика по близости комментов к посту работает на основе косинусных мер из Spacy. 
В папке src находятся вспомогательные файлы модели.

В отличие от прошлой версии заново был собран датасет для обучения, использовались промпты, дающие более развернутые суммаризации. Также размер датасета увеличился примерно на 27%.
Были проанализированы возможные суммаризации, и выделены часто встречающиеся вводные конструкции в ответах, например "В данном тексте говорится о...". Теперь такие конструкции исключаются на этапе обучения и инференса, чтобы итоговые ответы максимально походили на эталонные организаторские суммаризации. 

## Процесс запуска
В файле commands.txt в первой строке есть пример команды для запуска. Она удовлетворяет требованиям конкурса. Но тут тоже укажу ее:
```
python solution.py all_comments ./input/dataset.jsonl ./output/result.jsonl
```
Желательно запускать на GPU, на CPU будет долго работать.

## Зависимости
Установить надо не так уж много (6 пакетов и 1 корпус для spacy), скорее всего, всё это у вас уже стоит:
```
pip install sentencepiece
pip install jsonlines
pip install pandas
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
pip install transformers
pip install -U spacy
python -m spacy download ru_core_news_sm
```
Обратите внимание, что помимо установки пакетов для spacy нужно установить еще и корпус русского языка (последняя строка выше).
В файле dependencies.txt указаны эти же пакеты.
Установится, конечно, больше за счет дополнительных пакетов. Поэтому на всякий случай все пакеты окружения указаны в файле requirements.txt.